@Library('JenkinssharedLibraries') _
pipeline{
  agent any 
  tools {
    maven "maven3.8.6"
  }
  stages{  
    stage('1GetCode'){
      steps{
        sh "echo 'cloning the latest application version' "
        git "https://github.com/elvis-ngeh/maven-web-application"
      }
    }
  stage('Build'){
  steps{
      common("Build")
  }
}
stage('SonarqubeReport'){
    steps{
        common("SonarqubeReport")
    }
}
stage('Upload to Nexus'){
    steps{
        common("Upload to Nexus")
    }
}
stage('UATtest'){
 steps{
 sh "echo 'running a UAT test now' "
 deploy adapters: [tomcat9(credentialsId: 'tomcat-credentials', path: '', url: 'http://10.0.1.148:8080/')], contextPath: null, war: 'target/*war'
 }
}
stage('ApprovalGate'){
 steps{
 sh "echo 'review and approve pls' "
 timeout(time: 5, unit: 'DAYS'){
 input messages : 'pls review and approve, so we can proceed to prod'
 }
 } 
}
}

}

